<div class="container my-4">
  <div class="glass-container p-4">
    <h1>{{ 'answers.title' | translate }}</h1>

    <div class="status-filter mb-4">
      <button
        class="filter-btn filter-all"
        [class.active]="selectedTab==='all'"
        (click)="selectTab('all')">
        {{ 'answers.tabs.all' | translate }} ({{ allThematiques.length }})
      </button>
      <button
        class="filter-btn filter-complete"
        [class.active]="selectedTab==='completed'"
        (click)="selectTab('completed')">
        {{ 'answers.tabs.completed' | translate }} ({{ completedThematiques.length }})
      </button>
      <button
        class="filter-btn filter-incomplete"
        [class.active]="selectedTab==='incomplete'"
        (click)="selectTab('incomplete')">
        {{ 'answers.tabs.incomplete' | translate }} ({{ incompleteThematiques.length }})
      </button>
    </div>
    <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center" style="min-height: 60vh;">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">{{ 'answers.loading' | translate }}</span>
      </div>
    </div>

    <ng-container *ngIf="!isLoading">
      <div class="list-wrap">
        <div *ngIf="activeList.length > 0; else emptyState"
             class="row row-cols-1 row-cols-sm-2 row-cols-md-2 g-2">
          <div class="col mb-3" *ngFor="let r of pageItems">
            <app-card
              [mode]="'mes-reponses'"
              [id]="r.id"
              [title]="r.title"
              [description]="r.description"
              [publicationDate]="r.publicationDate"
              [isSessionOpen]="r.isSessionOpen"
              [sessionCloseDate]="r.sessionCloseDate"
              [isAnswered]="r.isAnswered"
              [responseDate]="r.responseDate || ''"
            ></app-card>
          </div>
        </div>
      </div>

      <nav *ngIf="activeList.length && totalPages > 1"
           class="pagination-wrap d-flex justify-content-center mt-4"
           [attr.aria-label]="'answers.title' | translate">
        <ul class="pagination">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <button class="page-link" (click)="firstPage()" [disabled]="currentPage === 1">&laquo;</button>
          </li>
          <li class="page-item" [class.disabled]="currentPage === 1">
            <button class="page-link" (click)="prevPage()" [disabled]="currentPage === 1">{{ 'answers.pagination.prev' | translate }}</button>
          </li>

          <li class="page-item" *ngFor="let p of pageNumbers" [class.active]="p === currentPage">
            <button class="page-link" (click)="goToPage(p)">{{ p }}</button>
          </li>

          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <button class="page-link" (click)="nextPage()" [disabled]="currentPage === totalPages">{{ 'answers.pagination.next' | translate }}</button>
          </li>
          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <button class="page-link" (click)="lastPage()" [disabled]="currentPage === totalPages">&raquo;</button>
          </li>
        </ul>
      </nav>
    </ng-container>

    <ng-template #emptyState>
      <div class="d-flex flex-column justify-content-center align-items-center" style="min-height: 60vh;">
        <img src="assets/images/empty-folder.png" [attr.alt]="'answers.empty' | translate" class="mb-3 img-fluid" style="max-width: 200px;" />
        <p class="fs-5 mb-0">{{ 'answers.empty' | translate }}</p>
      </div>
    </ng-template>
  </div>
</div>

