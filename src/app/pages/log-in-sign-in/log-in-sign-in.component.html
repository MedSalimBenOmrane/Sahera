<head>
  <title>Slide Navbar</title>
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500&display=swap" rel="stylesheet">
</head>

<body>
  <div class="auth-lang-switch" aria-label="Language selector">
    <button type="button"
            [class.active]="i18n.currentLang === 'fr'"
            (click)="setLang('fr')">FR</button>
    <button type="button"
            [class.active]="i18n.currentLang === 'en'"
            (click)="setLang('en')">EN</button>
  </div>
  <div class="login-wrapper">
    <div class="side-slideshow" [attr.aria-label]="'auth.slideshow.label' | translate">
      <div class="side-photo-frame">
        <img class="side-photo" src="assets/images/Capture.PNG" alt="Sahera visual" />
      </div>
    </div>
  <div class="main">
    <input type="checkbox" id="chk" aria-hidden="false" />

    <div class="signup">
      <form [formGroup]="signupForm" (ngSubmit)="onSignup()">
        <label class="titleInscription" for="chk" aria-hidden="false">{{ 'auth.signup.title' | translate }}</label>

        <input class="input"
          id="nom"
          type="text"
          formControlName="nom"
          [placeholder]="'auth.signup.name' | translate"
          (blur)="onBlurField('nom')"
          [class.error-border]="isFieldInvalid('nom')"
        />

        <input class="input"
          id="prenom"
          type="text"
          formControlName="prenom"
          [placeholder]="'auth.signup.firstName' | translate"
          (blur)="onBlurField('prenom')"
          [class.error-border]="isFieldInvalid('prenom')"
        />

        <input class="input"
          id="emailSignup"
          type="email"
          formControlName="email"
          placeholder="Email"
          (blur)="onBlurField('email')"
          [class.error-border]="isFieldInvalid('email')"
        />

        <input class="input"
          id="passwordSignup"
          type="password"
          formControlName="password"
          [placeholder]="'auth.signup.password' | translate"
          (blur)="onBlurField('password')"
          [class.error-border]="isFieldInvalid('password')"
        />

        <input class="input"
          id="telephone"
          type="text"
          formControlName="telephone"
          [placeholder]="'auth.signup.phone' | translate"
          (blur)="onBlurField('telephone')"
          [class.error-border]="isFieldInvalid('telephone')"
        />

        <div class="input-row date-row">
          <label class="date-label" for="dateNaissance">
            {{ 'auth.signup.birthDate' | translate }}
          </label>
          <input
            id="dateNaissance"
            class="input"
            type="date"
            formControlName="dateNaissance"
            (blur)="onBlurField('dateNaissance')"
            [class.error-border]="isFieldInvalid('dateNaissance')"
            [max]="maxDate"
          />
        </div>

        <div class="genre-container" role="group" aria-labelledby="genre-label">
  <span id="genre-label" class="genre-label">{{ 'auth.signup.genderLabel' | translate }}</span>

  <label class="genre-radio" [class.error-border]="isFieldInvalid('genre')" *ngFor="let opt of genderOptions">
    <input
      class="input"
      type="radio"
      formControlName="genre"
      [value]="opt.value"
      (change)="onBlurField('genre')"
    />
    {{ opt.labelKey | translate }}
  </label>
</div>

<select
  id="ethnicite"
  class="input"
  formControlName="ethnicite"
  (blur)="onBlurField('ethnicite')"
  [class.error-border]="isFieldInvalid('ethnicite')"
  required
>
  <option [ngValue]="null" disabled>{{ 'auth.signup.ethnicity' | translate }}</option>
  <option *ngFor="let opt of ethniciteOptions" [ngValue]="opt.value">{{ opt.labelKey | translate }}</option>
</select>


        <button type="submit">{{ 'auth.signup.submit' | translate }}</button>
      </form>
    </div>

    <div class="login">
      <form [formGroup]="loginForm" (ngSubmit)="onLogin()">
        <label class="titleConnexion" for="chk" aria-hidden="false">{{ 'auth.login.title' | translate }}</label>

        <input class="input"
          id="emailLogin"
          type="email"
          formControlName="email"
          placeholder="Email"
          (blur)="onBlurLoginField('email')"
          [class.error-border]="isLoginFieldInvalid('email')"
        />

        <input class="input"
                  id="passwordLogin"
          type="password"
          formControlName="password"
          [placeholder]="'auth.signup.password' | translate"
          (blur)="onBlurLoginField('password')"
          [class.error-border]="isLoginFieldInvalid('password')"
        />
        <div class="form-check">
  <input
    class="form-check-input "
    type="checkbox"            
    id="isAdmin"
    formControlName="isAdmin"
  />
  <label class="form-check-label" for="isAdmin">
    {{ 'auth.login.admin' | translate }}
  </label>
</div>




        <button type="submit">{{ 'auth.login.submit' | translate }}</button>
        <div class="pwd" (click)="openForgotDialog()">{{ 'auth.login.forgot' | translate }}</div>
        <div class="navbar-brand "><img src="assets/images/logo.png" alt="Brand Logo"></div>
      </form>
    </div>
  </div>
     
  </div>
</body>
<dialog #dialog>
  <h1 class="title">{{ 'auth.consent.title' | translate }}</h1>

  <div class="consent-box">
    <div class="consent-scroll" (scroll)="onConsentScroll($event)">
      <h2>{{ 'auth.consent.intro' | translate }}</h2>
      <h2>{{ 'auth.consent.projectTitle' | translate }}</h2>
      <p>{{ 'auth.consent.projectName' | translate }}</p>
      <h2>{{ 'auth.consent.goal' | translate }}</h2>
      <p>{{ 'auth.consent.goalText' | translate }}</p>
      <h2>{{ 'auth.consent.data' | translate }}</h2>
      <p>{{ 'auth.consent.dataText' | translate }}</p>
      <p>{{ 'auth.consent.questionnaires' | translate }}</p>
      <p>{{ 'auth.consent.security' | translate }}</p>
      <h2>{{ 'auth.consent.partnership' | translate }}</h2>
      <p>{{ 'auth.consent.partnershipText' | translate }}</p>
      <h2>{{ 'auth.consent.duration' | translate }}</h2>
      <p>{{ 'auth.consent.durationText' | translate }}</p>
      <ul class="consent-list">
        <li>{{ 'auth.consent.duration6' | translate }}</li>
        <li>{{ 'auth.consent.duration12' | translate }}</li>
      </ul>
      <p>{{ 'auth.consent.durationEnd' | translate }}</p>
      <p class="consent-mail">{{ 'auth.consent.contact' | translate }}
        <a href="mailto:info@sahera.ca" rel="noopener">{{ 'auth.consent.email' | translate }}</a>.
        {{ 'auth.consent.withdraw' | translate }}
      </p>
      <h2>{{ 'auth.consent.subtitle' | translate }}</h2>
      <p class="consent-note">{{ 'auth.consent.check' | translate }}</p>
    </div>
    <label class="consent-check">
      <input type="checkbox" [disabled]="!consentScrolled" [checked]="consentChecked" (change)="onConsentChanged($any($event.target).checked)" />
      {{ 'auth.consent.check' | translate }}
    </label>
  </div>

  <h2 class="subtitle">{{ 'auth.consent.otpTitle' | translate }}</h2>
  <form id="otp-form" (paste)="onOtpPaste($event)" (submit)="$event.preventDefault()">
    <input #otpInput type="text" class="otp-input" maxlength="1" [disabled]="!regToken"
           [value]="otpDigits[0]" (input)="onOtpInput(0,$event)" (keydown)="onOtpKeydown(0,$event)">
    <input #otpInput type="text" class="otp-input" maxlength="1" [disabled]="!regToken"
           [value]="otpDigits[1]" (input)="onOtpInput(1,$event)" (keydown)="onOtpKeydown(1,$event)">
    <input #otpInput type="text" class="otp-input" maxlength="1" [disabled]="!regToken"
           [value]="otpDigits[2]" (input)="onOtpInput(2,$event)" (keydown)="onOtpKeydown(2,$event)">
    <input #otpInput type="text" class="otp-input" maxlength="1" [disabled]="!regToken"
           [value]="otpDigits[3]" (input)="onOtpInput(3,$event)" (keydown)="onOtpKeydown(3,$event)">
    <input #otpInput type="text" class="otp-input" maxlength="1" [disabled]="!regToken"
           [value]="otpDigits[4]" (input)="onOtpInput(4,$event)" (keydown)="onOtpKeydown(4,$event)">
  </form>

  <div class="row">
    <div class="col-6">
      <button id="verify-btn" (click)="verifyOtp()" [disabled]="!regToken || verifying || otpDigits.join('').length!==5">{{ 'auth.consent.verify' | translate }}</button>
    </div>
    <div class="col-6">
      <button id="resend-btn" (click)="resendCode()" [disabled]="!regToken || resendCooldown>0">
        {{ 'auth.consent.resend' | translate }}<span *ngIf="resendCooldown>0"> ({{resendCooldown}}s)</span>
      </button>
    </div>
  </div>

  <button id="x" aria-label="close" (click)="closeDialog()">&times;</button>
</dialog>


<dialog #forgotDialog>
  <h1 class="title">{{ 'auth.forgot.title' | translate }}</h1>

  <div *ngIf="fpError" style="color:#b91c1c; margin-bottom:10px; font-weight:600;">
    {{ fpError | translate }}
  </div>

  <div style="margin-bottom: 12px;">
    <input
      type="email"
      class="input"
      placeholder="Email"
      [(ngModel)]="fpEmail"
      name="fpEmail"
      required
      
    />
    <button id="send-reset-code-btn"
            (click)="sendResetCode()"
            [disabled]="fpResetToken">{{ 'auth.forgot.send' | translate }}</button>
  </div>

  <form *ngIf="fpResetToken" (paste)="onFpOtpPaste($event)" (submit)="$event.preventDefault()"
        style="margin-top: 10px;">
    <div id="otp-form">
      <input type="text" class="otp-input fp-otp-input" maxlength="1"
             [value]="fpOtpDigits[0]" (input)="onFpOtpInput(0,$event)" (keydown)="onFpOtpKeydown(0,$event)">
      <input type="text" class="otp-input fp-otp-input" maxlength="1"
             [value]="fpOtpDigits[1]" (input)="onFpOtpInput(1,$event)" (keydown)="onFpOtpKeydown(1,$event)">
      <input type="text" class="otp-input fp-otp-input" maxlength="1"
             [value]="fpOtpDigits[2]" (input)="onFpOtpInput(2,$event)" (keydown)="onFpOtpKeydown(2,$event)">
      <input type="text" class="otp-input fp-otp-input" maxlength="1"
             [value]="fpOtpDigits[3]" (input)="onFpOtpInput(3,$event)" (keydown)="onFpOtpKeydown(3,$event)">
      <input type="text" class="otp-input fp-otp-input" maxlength="1"
             [value]="fpOtpDigits[4]" (input)="onFpOtpInput(4,$event)" (keydown)="onFpOtpKeydown(4,$event)">
    </div>

    <div class="row" style="margin-top: 14px;">
      <div class="col-6">
        <button id="verify-reset-btn" (click)="verifyResetOtp()" [disabled]="fpVerifying">{{ 'auth.forgot.verify' | translate }}</button>
      </div>
      <div class="col-6">
        <button id="resend-reset-btn" (click)="resendResetCode()" [disabled]="fpResendCooldown>0">
          {{ 'auth.forgot.resend' | translate }}<span *ngIf="fpResendCooldown>0"> ({{fpResendCooldown}}s)</span>
        </button>
      </div>
    </div>
  </form>

  <div style="margin-top: 18px;">
    <input type="password" class="input" [placeholder]="'auth.forgot.newPassword' | translate"
           [(ngModel)]="newPw" name="newPw"
           [disabled]="!fpVerified">
    <input type="password" class="input" [placeholder]="'auth.forgot.confirmPassword' | translate"
           [(ngModel)]="newPw2" name="newPw2"
           [disabled]="!fpVerified">
    <button (click)="saveNewPassword()" [disabled]="!fpVerified">{{ 'auth.forgot.save' | translate }}</button>
  </div>

  <button id="x" aria-label="close" (click)="closeForgotDialog()">&times;</button>
</dialog>

